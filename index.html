<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8" />

  <title>Playground</title>

  <style type="text/css">
  </style>
  <script src="http://cdn.peerjs.com/0.3/peer.js"></script>
</head>

<body>

  <script>
    (function(){
      var redirect = sessionStorage.redirect;
      delete sessionStorage.redirect;
      if (redirect && redirect != location.href) {
        history.replaceState(null, null, redirect);
      }
    })();
    
    var queryParams = location.search.slice(1).split('&').reduce(function(q,s){
      var [k, v] = s.split('=');
      var arrayParam = k.match(/^(.+)\[(\d*)\]/);
      if (arrayParam) {
        var [_match, arrayKey, arrayIndex] = arrayParam;
        if(!q[arrayKey]) q[arrayKey] = [];
        if (arrayIndex) q[arrayKey][arrayIndex] = v;
        else q[arrayKey].push(v);
      } else {
        q[k] = v;
      }
      return q;
    }, {});
    
    var peer = new Peer({key: 'p6zcgijuvfclq5mi'});
    document.write('<pre>'+JSON.stringify(queryParams, null, 4)+'</pre>');
  </script>

</body>


</html>
